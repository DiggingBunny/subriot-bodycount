<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì„­ë¼ ì¡´ìœ… í‚¬ ì¹´ìš´í„°</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet" />
  <script src="chatdata.js"></script>
  <style>
    :root {
      --gold: #c9a84c;
      --gold-light: #f0c96a;
      --red: #b02020;
      --red-bright: #e03030;
      --bg: #0a0a0b;
      --bg2: #111114;
      --bg3: #18181d;
      --text: #e8e4d8;
      --text-dim: #7a7770;
      --border: #2a2820;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html { scroll-behavior:smooth; }
    body {
      background:var(--bg); color:var(--text);
      font-family:'Noto Sans KR',sans-serif;
      min-height:100vh; overflow-x:hidden;
    }
    body::before {
      content:''; position:fixed; inset:0; pointer-events:none; z-index:0;
      background:
        radial-gradient(ellipse 60% 40% at 50% -10%,rgba(180,140,40,.12) 0%,transparent 70%),
        radial-gradient(ellipse 40% 30% at 80% 100%,rgba(150,20,20,.10) 0%,transparent 60%);
    }
    body::after {
      content:''; position:fixed; inset:0; pointer-events:none; z-index:0; opacity:.5;
      background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    }
    .container { position:relative; z-index:1; max-width:860px; margin:0 auto; padding:0 20px; }

    /* â”€â”€ í—¤ë” â”€â”€ */
    header { text-align:center; padding:60px 20px 40px; }
    .header-line { width:100px; height:1px; background:linear-gradient(90deg,transparent,var(--gold),transparent); margin:0 auto 28px; }
    h1 {
      font-family:'Black Han Sans',sans-serif;
      font-size:clamp(32px,8vw,64px);
      letter-spacing:-1px; line-height:1.1;
      background:linear-gradient(135deg,var(--gold-light) 0%,var(--gold) 50%,#8a6820 100%);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
      margin-bottom:28px;
      animation:titleGlow 3s ease-in-out infinite alternate;
    }
    @keyframes titleGlow {
      from { filter:drop-shadow(0 0 8px rgba(201,168,76,.3)); }
      to   { filter:drop-shadow(0 0 20px rgba(201,168,76,.6)); }
    }
    .header-meta { display:flex; flex-direction:column; align-items:center; gap:10px; }
    .badge {
      display:inline-flex; align-items:center; gap:8px;
      background:var(--bg3); border:1px solid var(--border); border-radius:2px;
      padding:6px 16px; font-size:11px; color:var(--text-dim); letter-spacing:1px;
    }
    .badge .dot { width:6px; height:6px; border-radius:50%; background:var(--gold); animation:pulse 2s ease-in-out infinite; }
    .badge .label { color:var(--gold); opacity:.7; }
    @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.4;transform:scale(.7)} }

    /* â”€â”€ ë‚ ì§œ í•„í„° â”€â”€ */
    .filter-section {
      background:var(--bg2); border:1px solid var(--border); border-radius:2px;
      padding:24px 20px; margin:32px 0;
      display:flex; flex-wrap:wrap; align-items:flex-end; gap:16px;
      box-sizing:border-box; overflow:hidden;
    }
    .filter-group { display:flex; flex-direction:column; gap:8px; flex:1; min-width:0; width:100%; box-sizing:border-box; }
    .filter-group label { font-size:10px; letter-spacing:3px; color:var(--gold); text-transform:uppercase; }
    .filter-group input[type="date"],
    .filter-group input[type="text"] {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background:var(--bg3); border:1px solid var(--border); color:var(--text);
      padding:10px 14px; font-family:'Noto Sans KR',sans-serif; font-size:14px;
      border-radius:2px; outline:none; width:100%; cursor:pointer;
      transition:border-color .2s;
      -webkit-text-fill-color: var(--text);
    }
    .filter-group input[type="date"]::-webkit-date-and-time-value { color:var(--text); }
    .filter-group input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(0.8) sepia(1) saturate(2) hue-rotate(5deg);
      cursor: pointer;
      opacity: 0.7;
    }
    .filter-group input[type="date"]:hover,
    .filter-group input[type="date"]:focus,
    .filter-group input[type="text"]:hover,
    .filter-group input[type="text"]:focus { border-color:var(--gold); }
    .filter-group input::placeholder { color: var(--text-dim); }
    .btn-group { display:flex; gap:10px; }
    .btn-apply {
      background:var(--gold); color:#0a0a0b; border:none;
      padding:10px 24px; font-family:'Black Han Sans',sans-serif;
      font-size:14px; letter-spacing:1px; border-radius:2px; cursor:pointer;
      transition:all .2s; white-space:nowrap;
    }
    .btn-apply:hover { background:var(--gold-light); transform:translateY(-1px); }
    .btn-reset {
      background:transparent; color:var(--text-dim); border:1px solid var(--border);
      padding:10px 16px; font-family:'Noto Sans KR',sans-serif; font-size:13px;
      border-radius:2px; cursor:pointer; transition:all .2s; white-space:nowrap;
    }
    .btn-reset:hover { border-color:var(--text-dim); color:var(--text); }
    .quick-filters { display:flex; gap:8px; flex-wrap:wrap; width:100%; }
    .quick-btn {
      background:transparent; color:var(--text-dim); border:1px solid var(--border);
      padding:4px 12px; font-size:11px; border-radius:2px; cursor:pointer;
      transition:all .2s; font-family:'Noto Sans KR',sans-serif; letter-spacing:.5px;
    }
    .quick-btn:hover, .quick-btn.active { border-color:var(--gold); color:var(--gold); }

    /* â”€â”€ ì´ í‚¬ ì¹´ìš´íŠ¸ â”€â”€ */
    .total-kills { text-align:center; padding:20px 0 32px; }
    .total-label { font-size:10px; letter-spacing:4px; color:var(--text-dim); text-transform:uppercase; margin-bottom:8px; }
    .total-number {
      font-family:'Black Han Sans',sans-serif; font-size:clamp(40px,10vw,80px);
      color:var(--red-bright); line-height:1;
      text-shadow:0 0 40px rgba(200,40,40,.4);
    }
    .total-unit { font-size:18px; color:var(--text-dim); margin-left:4px; }

    /* â”€â”€ ì„¹ì…˜ í—¤ë” â”€â”€ */
    .section-header { display:flex; align-items:center; gap:16px; margin-bottom:20px; }
    .section-title { font-family:'Black Han Sans',sans-serif; font-size:16px; letter-spacing:2px; color:var(--gold); }
    .section-line { flex:1; height:1px; background:var(--border); }

    /* â”€â”€ ë¦¬ë”ë³´ë“œ â”€â”€ */
    .leaderboard { display:flex; flex-direction:column; gap:10px; margin-bottom:40px; }
    .rank-item {
      background:var(--bg2); border:1px solid var(--border); border-radius:2px;
      padding:16px 20px; display:grid; grid-template-columns:48px 1fr auto;
      align-items:center; gap:16px; position:relative; overflow:hidden;
      transition:border-color .2s, transform .2s;
      animation:slideIn .4s ease both;
    }
    .rank-item:hover { border-color:var(--gold); transform:translateX(4px); }
    @keyframes slideIn { from{opacity:0;transform:translateX(-20px)} to{opacity:1;transform:translateX(0)} }
    .rank-item .kill-bar {
      position:absolute; left:0; top:0; bottom:0;
      background:linear-gradient(90deg,rgba(201,168,76,.08),transparent);
      transition:width .8s cubic-bezier(.22,1,.36,1); pointer-events:none;
    }
    .rank-item[data-rank="1"] { border-color:var(--gold); background:linear-gradient(135deg,rgba(201,168,76,.08) 0%,var(--bg2) 60%); }
    .rank-item[data-rank="1"] .kill-bar { background:linear-gradient(90deg,rgba(201,168,76,.15),transparent); }
    .rank-item[data-rank="2"] { border-color:#6a8aaa; }
    .rank-item[data-rank="3"] { border-color:#9a6840; }
    .rank-number { font-family:'Black Han Sans',sans-serif; font-size:24px; text-align:center; position:relative; }
    .rank-item[data-rank="1"] .rank-number { color:var(--gold); font-size:28px; }
    .rank-item[data-rank="2"] .rank-number { color:#8aaac8; }
    .rank-item[data-rank="3"] .rank-number { color:#c28850; }
    .rank-crown { display:block; font-size:14px; line-height:1; }
    .rank-info { display:flex; flex-direction:column; gap:4px; }
    .rank-name { font-size:16px; font-weight:700; color:var(--text); }
    .rank-item[data-rank="1"] .rank-name { font-size:18px; color:var(--gold-light); }
    .rank-bar-wrap { margin-top:6px; height:3px; background:var(--border); border-radius:1px; overflow:hidden; }
    .rank-bar-fill {
      height:100%; background:linear-gradient(90deg,var(--gold),var(--gold-light));
      border-radius:1px; width:0; transition:width 1s cubic-bezier(.22,1,.36,1);
    }
    .rank-item[data-rank="2"] .rank-bar-fill { background:linear-gradient(90deg,#6a8aaa,#9ab8d0); }
    .rank-item[data-rank="3"] .rank-bar-fill { background:linear-gradient(90deg,#9a6840,#c28850); }
    .rank-kills { font-family:'Black Han Sans',sans-serif; font-size:28px; color:var(--red-bright); text-align:right; white-space:nowrap; }
    .rank-kills-unit { font-size:12px; color:var(--text-dim); font-family:'Noto Sans KR',sans-serif; font-weight:300; }
    .rank-item[data-rank="1"] .rank-kills { font-size:34px; text-shadow:0 0 20px rgba(200,40,40,.5); }

    /* â”€â”€ ëœë¤ í‚¬ í˜„ì¥ â”€â”€ */
    .random-card {
      background:var(--bg2); border:1px solid var(--border); border-radius:2px;
      padding:32px 28px; text-align:center;
      display:flex; flex-direction:column; align-items:center; gap:16px;
      position:relative; overflow:hidden;
      transition:opacity .3s;
    }
    .random-card::before {
      content:'"'; position:absolute; top:-10px; left:16px;
      font-size:80px; color:var(--border); font-family:Georgia,serif; line-height:1; pointer-events:none;
    }
    .random-killer {
      font-family:'Black Han Sans',sans-serif; font-size:22px; color:var(--gold-light);
    }
    .random-message-box {
      background:var(--bg3); border:1px solid var(--border); border-radius:2px;
      padding:14px 20px; font-size:17px; color:var(--text); width:100%; text-align:center;
      font-weight:700; line-height:1.6;
    }
    .random-arrow {
      font-size:22px; color:var(--red-bright);
      text-shadow:0 0 12px rgba(200,40,40,.5);
    }
    .random-exited { font-size:13px; color:var(--text-dim); letter-spacing:1px; }
    .random-exited .exited-name { color:#e8e4d8; }
    .random-meta { font-size:11px; color:var(--text-dim); letter-spacing:1px; }
    .placeholder-text { font-size:14px; color:var(--text-dim); padding:20px 0; }
    .btn-random {
      background:transparent; color:var(--gold); border:1px solid var(--gold);
      padding:10px 28px; font-family:'Black Han Sans',sans-serif;
      font-size:14px; letter-spacing:2px; border-radius:2px; cursor:pointer;
      transition:all .2s; margin-top:8px;
    }
    .btn-random:hover { background:var(--gold); color:var(--bg); transform:translateY(-1px); }
    .btn-random:active { transform:scale(.97); }

    .empty-state { text-align:center; padding:60px 20px; color:var(--text-dim); font-size:14px; letter-spacing:1px; }
    .divider { width:40px; height:1px; background:var(--border); margin:32px auto; }
    footer { text-align:center; padding:40px 20px 60px; color:var(--text-dim); font-size:11px; letter-spacing:2px; border-top:1px solid var(--border); margin-top:40px; }

    @media(max-width:600px){
      .filter-section{ padding:16px; flex-direction:column; align-items:stretch; }
      .filter-group { flex:none; width:100%; }
      .filter-group input[type="date"] { width:100%; font-size:16px; }
      .btn-group { width:100%; }
      .btn-apply, .btn-reset { flex:1; text-align:center; }
      .rank-item{grid-template-columns:40px 1fr auto;padding:14px;}
      .rank-kills{font-size:22px;}
      .rank-item[data-rank="1"] .rank-kills{font-size:26px;}
    }
  </style>
</head>
<body>
<div class="container">

  <!-- í—¤ë” -->
  <header>
    <div class="header-line"></div>
    <h1>ì„­ë¼ ì¡´ìœ…<br>í‚¬ ì¹´ìš´í„°</h1>
    <div class="header-meta">
      <div class="badge">
        <span class="dot"></span>
        <span id="updatedAt">ë°ì´í„° ë¡œë”© ì¤‘...</span>
      </div>
      <div class="badge">
        <span class="label">ë°ì´í„° ê¸°ê°„&nbsp;</span>
        <span id="dataRange">ë¡œë”© ì¤‘...</span>
      </div>
    </div>
  </header>

  <!-- ë‚ ì§œ í•„í„° -->
  <section class="filter-section">
    <div class="filter-group">
      <label>ì‹œì‘ì¼</label>
      <input type="date" id="dateFrom" placeholder="YYYY-MM-DD" />
    </div>
    <div class="filter-group">
      <label>ì¢…ë£Œì¼</label>
      <input type="date" id="dateTo" placeholder="YYYY-MM-DD" />
    </div>
    <div class="btn-group">
      <button class="btn-apply" onclick="applyFilter()">ì¡°íšŒ</button>
      <button class="btn-reset" onclick="resetFilter()">ì „ì²´</button>
    </div>
    <div class="quick-filters">
      <button class="quick-btn" onclick="setThisMonth(this)">ì´ë²ˆ ë‹¬</button>
      <button class="quick-btn" onclick="setLastMonth(this)">ì§€ë‚œ ë‹¬</button>
      <button class="quick-btn" onclick="setQuick(90,this)">ìµœê·¼ 3ê°œì›”</button>
      <button class="quick-btn" onclick="setLastYear(this)">ìµœê·¼ 1ë…„</button>
    </div>
  </section>

  <!-- ì´ í‚¬ -->
  <div class="total-kills">
    <p class="total-label">ì¡°íšŒ ê¸°ê°„ ì´ í‚¬ ìˆ˜</p>
    <div>
      <span class="total-number" id="totalKills">0</span>
      <span class="total-unit">í‚¬</span>
    </div>
  </div>

  <!-- ë¦¬ë”ë³´ë“œ -->
  <div class="section-header">
    <span class="section-title">ğŸ† í‚¬ ìˆœìœ„</span>
    <div class="section-line"></div>
    <span style="font-size:11px;color:var(--text-dim);letter-spacing:1px;">TOP 10</span>
  </div>
  <div class="leaderboard" id="leaderboard">
    <div class="empty-state">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  </div>

  <div class="divider"></div>

  <!-- ëœë¤ í‚¬ í˜„ì¥ -->
  <section>
    <div class="section-header">
      <span class="section-title">ğŸ² ëœë¤ í‚¬ í˜„ì¥</span>
      <div class="section-line"></div>
    </div>
    <div class="random-card" id="randomCard">
      <p class="placeholder-text">ë²„íŠ¼ì„ ëˆŒëŸ¬ í‚¬ ìˆœê°„ì„ ì†Œí™˜í•˜ì„¸ìš”</p>
    </div>
    <div style="text-align:center;margin-top:16px;">
      <button class="btn-random" onclick="showRandomKill()">ğŸ”« í‚¬ ì†Œí™˜</button>
    </div>
  </section>

  <footer>
    <p>ì„­ë¼ ì¡´ìœ… í‚¬ ì¹´ìš´í„°</p>
  </footer>
</div>

<script>
  let allKills = [], filteredKills = [], minDate = '', maxDate = '';

  function init() {
    if (typeof CHAT_DATA === 'undefined' || !CHAT_DATA.kills) {
      document.getElementById('leaderboard').innerHTML = '<div class="empty-state">âš ï¸ chatdata.js íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
      return;
    }
    allKills = CHAT_DATA.kills;
    document.getElementById('updatedAt').textContent = `ì—…ë°ì´íŠ¸: ${CHAT_DATA.updatedAt}`;

    if (allKills.length > 0) {
      const dates = allKills.map(k => k.date).sort();
      minDate = dates[0];
      maxDate = dates[dates.length - 1];
      document.getElementById('dataRange').textContent = `${fmt(minDate)} ~ ${fmt(maxDate)}`;
      document.getElementById('dateFrom').value = '';
      document.getElementById('dateTo').value = '';
    }
    // ê¸°ë³¸ ìƒíƒœ: ì•ˆ ë³´ì´ê²Œ
    document.getElementById('totalKills').textContent = '-';
    document.getElementById('leaderboard').innerHTML =
      '<div class="empty-state">ê¸°ê°„ì„ ì„ íƒí•˜ê³  ì¡°íšŒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>';
  }

  function fmt(d) {
    return d.replace(/^(\d{4})-(\d{2})-(\d{2})$/, '$1.$2.$3');
  }

  function applyFilter() {
    const from = document.getElementById('dateFrom').value;
    const to   = document.getElementById('dateTo').value;
    filteredKills = (from && to) ? allKills.filter(k => k.date >= from && k.date <= to) : [...allKills];
    renderLeaderboard();
  }

  function resetFilter() {
    document.getElementById('dateFrom').value = minDate;
    document.getElementById('dateTo').value   = maxDate;
    document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('active'));
    applyFilter();
  }

  function setQuick(days, btn) {
    const to = new Date(), from = new Date();
    from.setDate(to.getDate() - days + 1);
    document.getElementById('dateFrom').value = fmtDate(from);
    document.getElementById('dateTo').value   = fmtDate(to);
    setActive(btn); applyFilter();
  }
  function setThisMonth(btn) {
    const n = new Date();
    document.getElementById('dateFrom').value = fmtDate(new Date(n.getFullYear(), n.getMonth(), 1));
    document.getElementById('dateTo').value   = fmtDate(new Date(n.getFullYear(), n.getMonth()+1, 0));
    setActive(btn); applyFilter();
  }
  function setLastMonth(btn) {
    const n = new Date();
    document.getElementById('dateFrom').value = fmtDate(new Date(n.getFullYear(), n.getMonth()-1, 1));
    document.getElementById('dateTo').value   = fmtDate(new Date(n.getFullYear(), n.getMonth(), 0));
    setActive(btn); applyFilter();
  }
  function setLastYear(btn) {
    const n = new Date();
    const from = new Date(n.getFullYear() - 1, n.getMonth(), n.getDate());
    document.getElementById('dateFrom').value = fmtDate(from);
    document.getElementById('dateTo').value   = fmtDate(n);
    setActive(btn); applyFilter();
  }
  function setActive(btn) {
    document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  }
  // toISOString()ì€ UTC ê¸°ì¤€ì´ë¼ KST(+9)ì—ì„œ ë‚ ì§œê°€ í•˜ë£¨ ë°€ë¦¼ â†’ ë¡œì»¬ ë‚ ì§œë¡œ ì§ì ‘ í¬ë§·
  function fmtDate(d) {
    const y = d.getFullYear();
    const m = String(d.getMonth() + 1).padStart(2, '0');
    const day = String(d.getDate()).padStart(2, '0');
    return `${y}-${m}-${day}`;
  }

  function renderLeaderboard() {
    const board = document.getElementById('leaderboard');
    const stats = {};
    filteredKills.forEach(k => { stats[k.killer] = (stats[k.killer] || 0) + 1; });
    const sorted = Object.entries(stats).sort((a,b) => b[1]-a[1]).slice(0,10);

    document.getElementById('totalKills').textContent = filteredKills.length;

    if (sorted.length === 0) {
      board.innerHTML = '<div class="empty-state">í•´ë‹¹ ê¸°ê°„ì— í‚¬ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
      return;
    }
    const maxK = sorted[0][1];

    board.innerHTML = sorted.map(([name, count], i) => {
      const rank = i + 1;
      const pct  = Math.round(count / maxK * 100);
      let rdisp  = rank;
      if (rank===1) rdisp = `<span class="rank-crown">ğŸ‘‘</span>1`;
      else if (rank===2) rdisp = `<span class="rank-crown">ğŸ¥ˆ</span>2`;
      else if (rank===3) rdisp = `<span class="rank-crown">ğŸ¥‰</span>3`;
      return `
        <div class="rank-item" data-rank="${rank}" style="animation-delay:${i*80}ms">
          <div class="kill-bar" style="width:${pct}%"></div>
          <div class="rank-number">${rdisp}</div>
          <div class="rank-info">
            <div class="rank-name">${esc(name)}</div>
            <div class="rank-bar-wrap"><div class="rank-bar-fill" data-pct="${pct}" style="width:0%"></div></div>
          </div>
          <div class="rank-kills">${count}<div class="rank-kills-unit">í‚¬</div></div>
        </div>`;
    }).join('');

    requestAnimationFrame(() => setTimeout(() => {
      document.querySelectorAll('.rank-bar-fill').forEach(el => { el.style.width = el.dataset.pct + '%'; });
    }, 100));
  }

  function showRandomKill() {
    if (!filteredKills.length) {
      document.getElementById('randomCard').innerHTML = '<p class="placeholder-text">í•´ë‹¹ ê¸°ê°„ì— í‚¬ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      return;
    }
    const card = document.getElementById('randomCard');
    card.style.opacity = '0';
    setTimeout(() => {
      const k = filteredKills[Math.floor(Math.random() * filteredKills.length)];
      
      const group = filteredKills.filter(x =>
        x.killer === k.killer && x.date === k.date &&
        x.time === k.time && x.message === k.message
      );
      const dateStr = k.date.replace(/-/g, '.') + ' ' + k.time;
      const exitedHTML = group.map(x =>
        `<span style="display:inline-block;margin:2px 4px;">ğŸšª <span class="exited-name">${esc(x.exited)}</span>ë‹˜ì´ ë‚˜ê°”ìŠµë‹ˆë‹¤</span>`
      ).join('<br>');

      // ë©€í‹°í‚¬ ë¼ë²¨ ë¡œì§ í™•ì¥
      let multiLabelText = '';
      if (group.length === 2) multiLabelText = 'ğŸ’€ DOUBLE KILL';
      else if (group.length === 3) multiLabelText = 'ğŸ’€ TRIPLE KILL';
      else if (group.length === 4) multiLabelText = 'ğŸ’€ QUADRA KILL';
      else if (group.length === 5) multiLabelText = 'ğŸ’€ PENTA KILL';
      else if (group.length > 5) multiLabelText = `ğŸ’€ ULTRA KILL (${group.length} KILLS)`;

      const multiLabel = multiLabelText 
        ? `<div style="font-size:11px;color:var(--red-bright);letter-spacing:2px;margin-bottom:-4px;">${multiLabelText}</div>`
        : '';

      card.innerHTML = `
        ${multiLabel}
        <div class="random-killer">ğŸ”« ${esc(k.killer)}</div>
        <div class="random-message-box">${esc(k.message)}</div>
        <div class="random-arrow">â†“</div>
        <div class="random-exited">${exitedHTML}</div>
        <div class="random-meta">${dateStr}</div>`;
      card.style.opacity = '1';
    }, 300);
  }

  function esc(s) {
    return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  document.getElementById('dateFrom').addEventListener('change', () => {
    document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('active'));
  });
  document.getElementById('dateTo').addEventListener('change', () => {
    document.querySelectorAll('.quick-btn').forEach(b => b.classList.remove('active'));
  });
  document.addEventListener('keydown', e => { if (e.key==='Enter') applyFilter(); });

  init();
</script>
</body>
</html>
